proxy-providers:
  tannel:
    type: http
    url: "https://psub.xpsub.fun/sub?target=clash&url=https%3A%2F%2FAhngt2qcyM.qinyues4.cc%2F513ef77981c9f88316ab9cdb811f7b87&insert=false"
    interval: 86400
    path: ./tannel.yaml
    exclude-filter: "北京时间|剩余流量|过期时间|网站地址"
    proxy: DIRECT
    health-check:
      enable: true
      url: https://www.google.com/generate_204
      interval: 300    
    override:
      udp: true
      down: "50 Mbps"
      up: "10 Mbps"
      skip-cert-verify: true
      
# 全局配置
port: 7890
socks-port: 7891
redir-port: 7892
mixed-port: 7893
tproxy-port: 7894
allow-lan: true    # 允许局域网
bind-address: "*"    # 绑定地址，仅允许其他设备通过这个地址访问
mode: Rule
log-level: info
ipv6: false
unified-delay: true    # 统一延迟
tcp-concurrent: true    # tcp并发
find-process-mode: off    # 控制是否让 Clash 去匹配进程
global-client-fingerprint: chrome    # 伪装指纹
# 移动设备省电
keep-alive-idle: 600
keep-alive-interval: 15
disable-keep-alive: false
profile:
  store-selected: true    # 储存 API 对策略组的选择，以供下次启动时使用
  store-fake-ip: true    # 储存 fakeip 映射表，域名再次发生连接时，使用原有映射地址

# 数据库
geo-auto-update: false # 是否自动更新 geodata
geo-update-interval: 24 # 更新间隔，单位：小时
geox-url:
  geoip: "https://github.xgithub.fun/https://github.com/MetaCubeX/meta-rules-dat/releases/download/latest/geoip-lite.dat"
  geosite: "https://github.xgithub.fun/https://github.com/MetaCubeX/meta-rules-dat/releases/download/latest/geosite.dat"
#  mmdb: "https://github.xgithub.fun/https://github.com/MetaCubeX/meta-rules-dat/releases/download/latest/country-lite.mmdb"
#  asn: "https://github.xgithub.fun/https://github.com/MetaCubeX/meta-rules-dat/releases/download/latest/GeoLite2-ASN.mmdb"

# 控制面板  
external-controller: 0.0.0.0:9090    # API控制面板
secret: ""

# 嗅探
sniffer:
  enable: true
  sniff:
    HTTP:
      ports: [80, 8080-8880]
      override-destination: true
    TLS:
      ports: [443, 8443]
    QUIC:
      ports: [443, 8443]
  force-domain:
    - "+.v2ex.com"
  skip-domain:
    - "+.baidu.com"

# 入站  
tun:
  enable: true
  # system/gvisor/mixed
  stack: mixed
  dns-hijack:
    - any:53
    - tcp://any:53
  auto-route: true
  auto-redirect: true
  auto-detect-interface: true
  route-exclude-address-set:
    - "rule-set:cn_ip"
  
# DNS模块
dns:
  enable: true
  listen: 0.0.0.0:1053
  ipv6: false
  respect-rules: true
  enhanced-mode: fake-ip
  fake-ip-range: 28.0.0.1/8
  fake-ip-filter-mode: blacklist
  fake-ip-filter:
    - "rule-set:private_domain,cn_domain"
    - "+.services.googleapis.cn"
    - "+.pool.ntp.org"
    - "+.ntp.tencent.com"
    - "+.ntp1.aliyun.com"
    - "+.ntp.ntsc.ac.cn"
    - "+.cn.ntp.org.cn"
    - "+.msftconnecttest.com"
    - "+.msftncsi.com"
    - "time.*.com"
  default-nameserver:
    - 223.5.5.5
    - 119.29.29.29
  direct-nameserver:  # 用于 direct 出口域名解析的 DNS 服务器
    - 223.5.5.5
  direct-nameserver-follow-policy: false
  proxy-server-nameserver:
    - https://223.5.5.5/dns-query
  # namesever尽量用运营商提供的DNS
  nameserver:
    - 223.5.5.5
    - 119.29.29.29
  fallback:
    - https://1.1.1.1/dns-query
    - tls://dns.rubyfish.cn:853

# 自建节点添加到这里
proxies: 

# 策略组
proxy-groups:
  - name: 🚀 节点选择
    type: select
    proxies:
      - 🇭🇰 香港自动
      - 🇺🇲 美国自动
      - 🌍 其他节点
      - DIRECT
      - ♻️ 自动选择      

  - name: 🇭🇰 香港自动
    type: url-test
    url: http://www.gstatic.com/generate_204
    interval: 300
    tolerance: 50
    use:
      - tannel
    filter: (?i)香港

  - name: 🇺🇲 美国自动
    type: url-test
    url: http://www.gstatic.com/generate_204
    interval: 300
    tolerance: 50
    use:
      - tannel
    filter: (?i)美国

  - name: 🌍 其他节点
    type: select
    use:
      - tannel
    exclude-filter: "香港|美国"

  - name: ♻️ 自动选择
    type: url-test
    url: http://www.gstatic.com/generate_204
    interval: 300
    tolerance: 50
    use:
      - tannel

  - name: 🐟 漏网之鱼
    type: select
    proxies:
      - 🚀 节点选择
      - DIRECT

  - name: 🏡 JNAS
    type: select
    proxies:
      - DIRECT    
      - 🚀 节点选择

  - name: 🤖 AI
    type: select
    proxies:
      - 🇭🇰 香港自动
      - 🇺🇲 美国自动
      - 🌍 其他节点
      - DIRECT

  - name: 🍎 Apple
    type: select
    proxies:
      - 🇭🇰 香港自动
      - 🇺🇲 美国自动
      - 🌍 其他节点
      - DIRECT

  - name: 🪟 Microsoft
    type: select
    proxies:
      - 🇭🇰 香港自动
      - 🇺🇲 美国自动
      - 🌍 其他节点
      - DIRECT

  - name: 🛑 广告拦截
    type: select
    proxies:
      - REJECT
      - DIRECT

rules:
  - SRC-IP-CIDR,192.168.110.211/32,🏡 JNAS
  - DOMAIN-SUFFIX,xn--ngstr-lra8j.com,🚀 节点选择
  - DOMAIN-SUFFIX,services.googleapis.cn,🚀 节点选择
  - RULE-SET,GoogleCNProxyIP,🚀 节点选择
  - RULE-SET,LocalAreaNetwork,DIRECT
  - RULE-SET,custom_ad,🛑 广告拦截
  - RULE-SET,custom_direct,DIRECT
  - RULE-SET,custom_HK,🇭🇰 香港自动
  - RULE-SET,custom_US,🇺🇲 美国自动
  - RULE-SET,whatsApp,🚀 节点选择
  - RULE-SET,ai_domain,🤖 AI
  - RULE-SET,google_domain,🚀 节点选择
  - RULE-SET,youtube_domain,🚀 节点选择
  - RULE-SET,github_domain,🚀 节点选择  
  - RULE-SET,tiktok_domain,🇺🇲 美国自动
  - RULE-SET,telegram_domain,🚀 节点选择
  - RULE-SET,netflix_domain,🇺🇲 美国自动
  - RULE-SET,paypal_domain,🚀 节点选择
  - RULE-SET,gfw_domain,🚀 节点选择
  - RULE-SET,geolocation-!cn_domain,🚀 节点选择
  - RULE-SET,microsoft_domain,🪟 Microsoft
  - RULE-SET,onedrive_domain,🪟 Microsoft
  - RULE-SET,apple_domain,🍎 Apple
  - RULE-SET,google_ip,🚀 节点选择,no-resolve
  - RULE-SET,telegram_ip,🚀 节点选择,no-resolve
  - RULE-SET,netflix_ip,🇺🇲 美国自动,no-resolve
  - RULE-SET,cn_domain,DIRECT
  - RULE-SET,speedtest_domain,DIRECT
  - RULE-SET,cn_ip,DIRECT,no-resolve
  - MATCH,🐟 漏网之鱼

# 规则集
rule-providers:

# 域名集
  GoogleCNProxyIP:
    type: http
    url: "https://github.xgithub.fun/https://raw.githubusercontent.com/ACL4SSR/ACL4SSR/master/Clash/Ruleset/GoogleCNProxyIP.list"
    path: ./GoogleCNProxyIP.list
    interval: 86400
    behavior: classical
    format: text
    proxy: DIRECT

  LocalAreaNetwork:
    type: http
    url: "https://github.xgithub.fun/https://raw.githubusercontent.com/JakeFan352/VPN/refs/heads/main/LocalAreaNetwork.list"
    path: ./LocalAreaNetwork.list
    interval: 86400
    behavior: classical
    format: text
    proxy: DIRECT

  apple_domain:
    type: http
    url: "https://github.xgithub.fun/https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/meta/geo/geosite/apple-cn.yaml"
    path: ./apple_domain.yaml
    interval: 86400
    behavior: domain
    format: yaml
    proxy: DIRECT
    
  ai_domain:
    type: http
    url: "https://github.xgithub.fun/https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/refs/heads/meta/geo/geosite/category-ai-!cn.yaml"
    path: ./ai_domain.yaml
    interval: 86400
    behavior: domain
    format: yaml
    proxy: DIRECT

  google_domain:
    type: http
    url: "https://github.xgithub.fun/https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/meta/geo/geosite/google.yaml"
    path: ./google_domain.yaml
    interval: 86400
    behavior: domain
    format: yaml
    proxy: DIRECT
    
  youtube_domain:
    type: http
    url: "https://github.xgithub.fun/https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/meta/geo/geosite/youtube.yaml"
    path: ./youtube_domain.yaml
    interval: 86400
    behavior: domain
    format: yaml    
    proxy: DIRECT
    
  github_domain:
    type: http
    url: "https://github.xgithub.fun/https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/meta/geo/geosite/github.yaml"
    path: ./github_domain.yaml
    interval: 86400
    behavior: domain
    format: yaml
    proxy: DIRECT
    
  tiktok_domain:
    type: http
    url: "https://github.xgithub.fun/https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/meta/geo/geosite/tiktok.yaml"
    path: ./tiktok_domain.yaml
    interval: 86400
    behavior: domain
    format: yaml
    proxy: DIRECT
    
  telegram_domain:
    type: http
    url: "https://github.xgithub.fun/https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/meta/geo/geosite/telegram.yaml"
    path: ./telegram_domain.yaml
    interval: 86400
    behavior: domain
    format: yaml
    proxy: DIRECT
    
  netflix_domain:
    type: http
    url: "https://github.xgithub.fun/https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/meta/geo/geosite/netflix.yaml"
    path: ./netflix_domain.yaml
    interval: 86400
    behavior: domain
    format: yaml
    proxy: DIRECT
    
  paypal_domain:
    type: http
    url: "https://github.xgithub.fun/https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/meta/geo/geosite/paypal.yaml"
    path: ./paypal_domain.yaml
    interval: 86400
    behavior: domain
    format: yaml
    proxy: DIRECT
    
  gfw_domain:
    type: http
    url: "https://github.xgithub.fun/https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/meta/geo/geosite/gfw.yaml"
    path: ./gfw_domain.yaml
    interval: 86400
    behavior: domain
    format: yaml
    proxy: DIRECT
    
  geolocation-!cn_domain:
    type: http
    url: "https://github.xgithub.fun/https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/meta/geo/geosite/geolocation-!cn.yaml"
    path: ./geolocation-!cn_domain.yaml
    interval: 86400
    behavior: domain
    format: yaml
    proxy: DIRECT
    
  microsoft_domain:
    type: http
    url: "https://github.xgithub.fun/https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/meta/geo/geosite/microsoft.yaml"
    path: ./microsoft_domain.yaml
    interval: 86400
    behavior: domain
    format: yaml
    proxy: DIRECT

  onedrive_domain:
    type: http
    url: "https://github.xgithub.fun/https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/meta/geo/geosite/onedrive.yaml"
    path: ./onedrive_domain.yaml
    interval: 86400
    behavior: domain
    format: yaml
    proxy: DIRECT

  cn_domain:
    type: http
    url: "https://github.xgithub.fun/https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/meta/geo/geosite/cn.yaml"
    path: ./cn_domain.yaml
    interval: 86400
    behavior: domain
    format: yaml
    proxy: DIRECT

  speedtest_domain:
    type: http
    url: "https://github.xgithub.fun/https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/meta/geo/geosite/ookla-speedtest.yaml"
    path: ./speedtest_domain.yaml
    interval: 86400
    behavior: domain
    format: yaml
    proxy: DIRECT

# ip集
  google_ip:
    type: http
    url: "https://github.xgithub.fun/https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/meta/geo/geoip/google.yaml"
    path: ./google_ip.yaml
    interval: 86400
    behavior: ipcidr
    format: yaml
    proxy: DIRECT

  telegram_ip:
    type: http
    url: "https://github.xgithub.fun/https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/meta/geo/geoip/telegram.yaml"
    path: ./telegram_ip.yaml
    interval: 86400
    behavior: ipcidr
    format: yaml
    proxy: DIRECT

  netflix_ip:
    type: http
    url: "https://github.xgithub.fun/https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/meta/geo/geoip/netflix.yaml"
    path: ./netflix_ip.yaml
    interval: 86400
    behavior: ipcidr
    format: yaml
    proxy: DIRECT 
    
  cn_ip:
    type: http
    url: "https://github.xgithub.fun/https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/meta/geo/geoip/cn.yaml"
    path: ./cn_ip.yaml
    interval: 86400
    behavior: ipcidr
    format: yaml
    proxy: DIRECT

# 自定义集classical,yaml

  whatsApp:
    type: http
    url: "https://github.xgithub.fun/https://raw.githubusercontent.com/JakeFan352/VPN/refs/heads/main/whatsApp.yaml"
    path: ./whatsApp.yaml
    interval: 86400
    behavior: classical
    format: yaml
    proxy: DIRECT

  custom_direct:
    type: http
    url: "https://github.xgithub.fun/https://raw.githubusercontent.com/JakeFan352/VPN/refs/heads/main/custom_direct.yaml"
    path: ./custom_direct.yaml
    interval: 86400
    behavior: classical
    format: yaml
    proxy: DIRECT

  custom_HK:
    type: http
    url: "https://github.xgithub.fun/https://raw.githubusercontent.com/JakeFan352/VPN/refs/heads/main/custom_HK.yaml"
    path: ./custom_HK.yaml
    interval: 86400
    behavior: classical
    format: yaml
    proxy: DIRECT

  custom_US:
    type: http
    url: "https://github.xgithub.fun/https://raw.githubusercontent.com/JakeFan352/VPN/refs/heads/main/custom_US.yaml"
    path: ./custom_US.yaml
    interval: 86400
    behavior: classical
    format: yaml
    proxy: DIRECT

  custom_ad:
    type: http
    url: "https://github.xgithub.fun/https://raw.githubusercontent.com/JakeFan352/VPN/refs/heads/main/custom_ad.yaml"
    path: ./custom_ad.yaml
    interval: 86400
    behavior: domain
    format: yaml
    proxy: DIRECT
